# 端到端判题测试文档

## 测试目标
验证从前端提交代码到显示判题结果的完整流程

## 前置条件
- ✅ 后端服务运行在 http://localhost:8080
- ✅ 判题服务器运行在 http://localhost:8081
- ✅ 前端服务运行在 http://localhost:5174

## 测试步骤

### 1. 登录系统
访问 http://localhost:5174
使用测试账号登录（如果需要）

### 2. 选择题目
- 访问题库列表页
- 选择题目 **P001 - A+B Problem** (ID: 6)
- 点击进入题目详情页

### 3. 编写代码
选择语言：**Python**

粘贴以下代码：
```python
a, b = map(int, input().split())
print(a + b)
```

### 4. 提交代码
点击"提交代码"按钮

### 5. 观察判题过程
- 应该立即显示：**"代码已提交，正在判题..."**
- 前端开始轮询判题状态（每1秒查询一次）
- 状态变化：PENDING → JUDGING → AC

### 6. 验证判题结果
- 应该弹出消息：**"答案正确 | 运行时间: XXms | 通过用例: 2/2"**
- 提交记录列表自动刷新
- 最新提交显示为 **"通过"** 状态，绿色显示

## 预期结果

### API测试结果（已验证）
```json
{
  "status": "ac",
  "message": "答案正确",
  "timeUsed": 24,
  "passCount": 2,
  "totalCount": 2
}
```

### 前端显示效果
- ✅ 提交成功提示
- ✅ 实时状态更新
- ✅ 判题结果弹窗
- ✅ 提交记录刷新

## 测试用例数据

题目 P001 的测试用例：
```sql
SELECT * FROM test_cases WHERE question_id = 6;
```

预期：
- 测试用例1: 输入 "1 2"，输出 "3"
- 测试用例2: 输入 "5 10"，输出 "15"

## 错误排查

### 如果判题失败
1. 检查判题服务器日志
2. 检查后端日志
3. 检查前端控制台

### 如果轮询不工作
1. 打开浏览器开发者工具
2. 查看 Network 面板
3. 确认每1秒发送一次 GET /api/submissions/{id} 请求

### 如果状态不更新
1. 检查 SubmissionService 的异步判题方法
2. 确认 @EnableAsync 已启用
3. 查看数据库 submissions 表是否更新

## 下一步优化

- [ ] 支持C++和Java语言（需要安装编译器或Docker）
- [ ] 将轮询改为WebSocket推送
- [ ] 添加判题队列（Redis或RabbitMQ）
- [ ] 显示更详细的错误信息
- [ ] 添加代码运行结果展示

## 测试时间
2025-10-14 23:58

## 测试人员
AI Assistant

## 测试状态
✅ API层测试通过
⏳ 前端E2E测试待执行
